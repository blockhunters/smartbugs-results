import os
import json

ROOT = os.path.realpath(os.path.join(os.path.dirname(__file__), '..'))


vulnerability_mapping = {}
with open(os.path.join(ROOT, 'metadata/vulnerabilities_mapping.csv')) as fd:
    header = fd.readline().strip().split(',')
    line = fd.readline()
    while line:
        v = line.strip().split(',')
        index = -1
        if 'TRUE' in v:
            index = v.index('TRUE')
        elif 'MAYBE' in v:
            index = v.index('MAYBE')
        if index > -1:
            vulnerability_mapping[v[1]] = header[index]
        line = fd.readline()
categories = sorted(list(set(vulnerability_mapping.values())))

vulnerabilities = None
with open(os.path.join(ROOT, 'metadata/vulnerabilities.json')) as f:
    vulnerabilities = json.load(f)
